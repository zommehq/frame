= Angular Integration

Fragment Elements works with Angular applications.

== Parent Application (Angular)

=== Enable Custom Elements

[source,typescript]
----
// app.config.ts
import { ApplicationConfig, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';

export const appConfig: ApplicationConfig = {
  providers: [
    // ... other providers
  ],
};

// app.component.ts
import { Component, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';

@Component({
  selector: 'app-root',
  schemas: [CUSTOM_ELEMENTS_SCHEMA],
  template: `...`,
})
export class AppComponent {}
----

=== Basic Usage

[source,typescript]
----
import { Component, OnInit, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';
import '@micro-fe/fragment-elements/fragment-frame';

@Component({
  selector: 'app-root',
  schemas: [CUSTOM_ELEMENTS_SCHEMA],
  template: `
    <fragment-frame
      name="user-app"
      src="http://localhost:3001"
      base="/users"
      [attr.theme]="theme"
    ></fragment-frame>
  `,
})
export class AppComponent {
  theme = 'dark';
}
----

=== Component Wrapper

[source,typescript]
----
import { Component, Input, ViewChild, ElementRef, AfterViewInit, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';
import type { FragmentFrame } from '@micro-fe/fragment-elements';

@Component({
  selector: 'app-fragment',
  schemas: [CUSTOM_ELEMENTS_SCHEMA],
  template: '<fragment-frame #fragment [attr.name]="name" [attr.src]="src"></fragment-frame>',
})
export class FragmentComponent implements AfterViewInit {
  @Input() name!: string;
  @Input() src!: string;
  @Input() apiUrl?: string;
  @Input() theme?: string;

  @ViewChild('fragment') fragmentRef!: ElementRef<FragmentFrame>;

  ngAfterViewInit() {
    const fragment = this.fragmentRef.nativeElement;
    if (this.apiUrl) fragment.apiUrl = this.apiUrl;
    if (this.theme) fragment.theme = this.theme;
  }
}
----

== Fragment Application (Angular)

=== Basic Setup

[source,typescript]
----
import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';
import { AppModule } from './app/app.module';
import { frameSDK } from '@micro-fe/fragment-elements/sdk';

frameSDK.initialize().then(() => {
  platformBrowserDynamic()
    .bootstrapModule(AppModule)
    .catch((err) => console.error(err));
});
----

[source,typescript]
----
import { Component, OnInit } from '@angular/core';
import { frameSDK } from '@micro-fe/fragment-elements/sdk';

@Component({
  selector: 'app-root',
  template: `
    <div [attr.data-theme]="config.theme">
      <h1>Fragment: {{ config.name }}</h1>
    </div>
  `,
})
export class AppComponent implements OnInit {
  config = frameSDK.props;

  ngOnInit() {
    frameSDK.on('attr:theme', (theme) => {
      this.config = { ...frameSDK.props };
    });
  }
}
----
