<div class="app-shell">
  <header class="header">
    <nav class="nav">
      <!-- Angular Logo -->
      <a routerLink="/angular" routerLinkActive="active" class="nav-link nav-link-angular" title="Angular">
        <svg width="16" height="16" viewBox="0 0 256 272" xmlns="http://www.w3.org/2000/svg">
          <path fill="currentColor" d="M.1 45.522L125.908.697l129.196 44.028-20.919 166.45-108.277 59.966-106.583-59.169L.1 45.522z"/>
          <path fill="#FFF" d="M255.104 44.725L125.908.697v270.444l108.277-59.866 20.919-166.55z"/>
          <path fill="currentColor" d="M126.107 32.274L47.714 206.693l29.285-.498 15.739-39.347h70.325l17.233 39.845 27.99.498-82.179-174.917zm.2 55.882l26.496 55.383h-49.806l23.31-55.383z"/>
        </svg>
      </a>
      <!-- React Logo -->
      <a routerLink="/react" routerLinkActive="active" class="nav-link nav-link-react" title="React">
        <svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="2.139" fill="currentColor"/>
          <ellipse cx="12" cy="12" rx="11" ry="4.222" fill="none" stroke="currentColor" stroke-width="1"/>
          <ellipse cx="12" cy="12" rx="11" ry="4.222" fill="none" stroke="currentColor" stroke-width="1" transform="rotate(60 12 12)"/>
          <ellipse cx="12" cy="12" rx="11" ry="4.222" fill="none" stroke="currentColor" stroke-width="1" transform="rotate(120 12 12)"/>
        </svg>
      </a>
      <!-- Vue Logo -->
      <a routerLink="/vue" routerLinkActive="active" class="nav-link nav-link-vue" title="Vue">
        <svg width="16" height="16" viewBox="0 0 256 221" xmlns="http://www.w3.org/2000/svg">
          <path fill="currentColor" d="M204.8 0H256L128 220.8 0 0h97.92L128 51.2 157.44 0h47.36z"/>
          <path fill="currentColor" opacity="0.6" d="M0 0l128 220.8L256 0h-51.2L128 132.48 50.56 0H0z"/>
        </svg>
      </a>
      <button class="theme-toggle" [title]="'Current theme: ' + settings.theme()" (click)="toggleTheme()">
        <!-- Sun Icon (Light mode) -->
        <svg *ngIf="settings.theme() === 'light'" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"/>
          <line x1="12" y1="1" x2="12" y2="3"/>
          <line x1="12" y1="21" x2="12" y2="23"/>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
          <line x1="1" y1="12" x2="3" y2="12"/>
          <line x1="21" y1="12" x2="23" y2="12"/>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
        </svg>
        <!-- Moon Icon (Dark mode) -->
        <svg *ngIf="settings.theme() === 'dark'" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
      </button>
      <!-- Frame Actions -->
      <div class="frame-actions" [class.angular]="activeFrame() === 'angular'" [class.react]="activeFrame() === 'react'" [class.vue]="activeFrame() === 'vue'">
        <button (click)="testGetStats()" title="Get stats from child frame">Stats</button>
        <button (click)="testRefreshData()" title="Trigger data refresh in child">Refresh</button>
        <button (click)="testNavigateTo('/settings')" title="Navigate child to Settings">Settings</button>
        <button (click)="testNavigateTo('/tasks')" title="Navigate child to Tasks">Tasks</button>
      </div>
    </nav>
  </header>
  <main class="main">
    <!-- Angular Frame -->
    <z-frame
      name="angular"
      src="http://localhost:4200/"
      [pathname]="getFramePathname('angular')"
      [class.hidden]="activeFrame() !== 'angular'"
      [filteredTasks]="tasks.filteredTasks()"
      [filter]="tasks.filter()"
      [searchQuery]="tasks.searchQuery()"
      [taskStats]="tasks.taskStats()"
      [theme]="settings.theme()"
      [user]="settings.user()"
      [addTask]="tasks.addTask"
      [addRandomTask]="tasks.addRandomTask"
      [deleteTask]="tasks.deleteTask"
      [toggleTask]="tasks.toggleTask"
      [updateTask]="tasks.updateTask"
      [getTaskStats]="tasks.getTaskStats"
      [refreshTasks]="tasks.refreshTasks"
      [clearCompleted]="tasks.clearCompleted"
      [setFilter]="tasks.setFilter"
      [setSearchQuery]="tasks.setSearchQuery"
      [changeTheme]="handleChangeTheme"
      (ready)="onFrameReady($event)"
      (navigate)="onFrameNavigate($event)"
      (error)="onFrameError($event)"
      (register)="onFrameRegister($event)"
      (unregister)="onFrameUnregister($event)"
    ></z-frame>
    <!-- React Frame -->
    <z-frame
      name="react"
      src="http://localhost:4201/"
      [pathname]="getFramePathname('react')"
      [class.hidden]="activeFrame() !== 'react'"
      [filteredTasks]="tasks.filteredTasks()"
      [filter]="tasks.filter()"
      [searchQuery]="tasks.searchQuery()"
      [taskStats]="tasks.taskStats()"
      [theme]="settings.theme()"
      [user]="settings.user()"
      [addTask]="tasks.addTask"
      [addRandomTask]="tasks.addRandomTask"
      [deleteTask]="tasks.deleteTask"
      [toggleTask]="tasks.toggleTask"
      [updateTask]="tasks.updateTask"
      [getTaskStats]="tasks.getTaskStats"
      [refreshTasks]="tasks.refreshTasks"
      [clearCompleted]="tasks.clearCompleted"
      [setFilter]="tasks.setFilter"
      [setSearchQuery]="tasks.setSearchQuery"
      [changeTheme]="handleChangeTheme"
      (ready)="onFrameReady($event)"
      (navigate)="onFrameNavigate($event)"
      (error)="onFrameError($event)"
      (register)="onFrameRegister($event)"
      (unregister)="onFrameUnregister($event)"
    ></z-frame>
    <!-- Vue Frame -->
    <z-frame
      name="vue"
      src="http://localhost:4202/"
      [pathname]="getFramePathname('vue')"
      [class.hidden]="activeFrame() !== 'vue'"
      [filteredTasks]="tasks.filteredTasks()"
      [filter]="tasks.filter()"
      [searchQuery]="tasks.searchQuery()"
      [taskStats]="tasks.taskStats()"
      [theme]="settings.theme()"
      [user]="settings.user()"
      [addTask]="tasks.addTask"
      [addRandomTask]="tasks.addRandomTask"
      [deleteTask]="tasks.deleteTask"
      [toggleTask]="tasks.toggleTask"
      [updateTask]="tasks.updateTask"
      [getTaskStats]="tasks.getTaskStats"
      [refreshTasks]="tasks.refreshTasks"
      [clearCompleted]="tasks.clearCompleted"
      [setFilter]="tasks.setFilter"
      [setSearchQuery]="tasks.setSearchQuery"
      [changeTheme]="handleChangeTheme"
      (ready)="onFrameReady($event)"
      (navigate)="onFrameNavigate($event)"
      (error)="onFrameError($event)"
      (register)="onFrameRegister($event)"
      (unregister)="onFrameUnregister($event)"
    ></z-frame>
  </main>
</div>
